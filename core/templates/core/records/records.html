{% extends "core/base.html" %}
{% block title %}NahrÃ¡vky{% endblock %}

{% block content %}

<style>
  .page-header {
    margin-bottom: 20px;
  }
</style>


<div class="bg-white border rounded-3 shadow-sm mb-3 px-3"
     style="height: 60px; display:flex; align-items:center; padding-top: 8px; padding-bottom: 8px;">


    <div class="d-flex justify-content-between align-items-center w-100">

        <!-- ğŸ”¹ Filter -->
        <div class="d-flex align-items-center gap-2">
            <span class="fw-semibold">Filtrovat podle:</span>

            <select class="form-select form-select-sm" style="width: 210px;">
                <option value="date">Datum</option>
                <option value="probability" selected>
                    PravdÄ›podobnost detekce
                </option>
            </select>
        </div>

        <!-- ğŸ”¹ Tlacitko -->
        <button class="btn btn-primary btn-sm">
            NaÄÃ­st nahrÃ¡vky
        </button>

    </div>

</div>



<!-- ğŸ”¹ TABUÄ½KA NAHRÃVOK -->
<div class="bg-white border rounded-3 shadow-sm mt-3 p-3"
     style="max-height: calc(100vh - 220px); overflow-y: auto;">

  {% if records_list %}

    <table class="table table-hover align-middle mb-0">
      <thead class="table-light position-sticky top-0">
        <tr>
          <th style="width: 70px;">ÄŒÃ­slo</th>
          <th>Datum & ÄŒas</th>
          <th>Soubor</th>
          <th>PravdÄ›podobnost</th>
        </tr>
      </thead>

      <tbody>
        {% for rec in records_list %}
        <tr>
          <td>{{ forloop.counter0|add:records_list.start_index }}</td>

          <td>
            {{ rec.date_time|date:"Y-m-d" }}
            {{ rec.date_time|time:"H:i:s" }}
          </td>

          <td>
            <audio controls style="height:32px;">
              <source src="{{ rec.audio_file.url }}" type="audio/wav">
            </audio>
          </td>

          <td>
            {% if rec.detection_probability %}
              {{ rec.detection_probability|floatformat:2 }} %
            {% else %}
              <span class="text-muted">â€“</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

  {% else %}
    <!-- Å½IADNE NÃHRAVKY -->
    <div class="text-center text-muted py-4 fs-5">
        Å½Ã¡dnÃ© nahrÃ¡vky nebyly nalezeny.
    </div>
  {% endif %}

</div>


<!-- ğŸ”¹ PAGINÃCIA + PAGE SIZE -->
<div class="d-flex justify-content-between align-items-center mt-3">

  <!-- Items per page -->
  <div class="btn-group" role="group">
    {% for size in page_sizes %}
      <a href="?size={{ size }}"
         class="btn btn-sm {% if page_size == size %}btn-primary{% else %}btn-secondary{% endif %}">
        {{ size }}
      </a>
    {% endfor %}
  </div>

  <!-- Paginator -->
  <nav>
    <ul class="pagination mb-0">

      {% if records_list.has_previous %}
        <li class="page-item">
          <a class="page-link" href="?page=1&size={{ page_size }}">Â«</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ records_list.previous_page_number }}&size={{ page_size }}">â€¹</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">Â«</span></li>
        <li class="page-item disabled"><span class="page-link">â€¹</span></li>
      {% endif %}


      {% for num in records_list.paginator.page_range %}
        {% if num >= records_list.number|add:'-2' and num <= records_list.number|add:'2' %}
          {% if num == records_list.number %}
            <li class="page-item active"><span class="page-link">{{ num }}</span></li>
          {% else %}
            <li class="page-item"><a class="page-link" href="?page={{ num }}&size={{ page_size }}">{{ num }}</a></li>
          {% endif %}
        {% endif %}
      {% endfor %}


      {% if records_list.has_next %}
        <li class="page-item">
          <a class="page-link" href="?page={{ records_list.next_page_number }}&size={{ page_size }}">â€º</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="?page={{ records_list.paginator.num_pages }}&size={{ page_size }}">Â»</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">â€º</span></li>
        <li class="page-item disabled"><span class="page-link">Â»</span></li>
      {% endif %}

    </ul>
  </nav>
</div>


{% endblock %}
